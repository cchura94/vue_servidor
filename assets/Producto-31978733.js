import{g as ee,r as n,b as ae,d as r,o as b,c as f,a as l,f as t,w as i,F as E,h as _,t as g,n as F,i as S,j as te}from"./index-b162bc2b.js";import{p as h}from"./ProductoService-a271b993.js";import{c as oe}from"./CategoriaService-cdabcc48.js";const le={class:"card"},se={class:"my-2"},ie=l("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},[l("h5",{class:"m-0"},"Gestionar Productos"),l("span",{class:"block mt-2 md:mt-0 p-input-icon-left"},[l("i",{class:"pi pi-search"})])],-1),ne=l("span",{class:"p-column-title"},"ID",-1),re=l("span",{class:"p-column-title"},"Nombre",-1),de=l("span",{class:"p-column-title"},"Imagen",-1),ce=["src","alt"],ue=l("span",{class:"p-column-title"},"Precio",-1),me=l("span",{class:"p-column-title"},"Categoria",-1),pe=l("p",null,"Arrastre su archvos aquí.",-1),ve={class:"field"},be=l("label",{for:"name"},"Nombre",-1),fe={key:0,class:"p-invalid"},_e={class:"field"},ge=l("label",{for:"description"},"Descripción",-1),ye={class:"field"},he=l("label",{class:"mb-3"},"Categoria",-1),we={class:"formgrid grid"},Ce=["for"],Pe={class:"formgrid grid"},ke={class:"field col"},xe=l("label",{for:"price"},"Precio",-1),Ve={key:0,class:"p-invalid"},De={class:"field col"},Se=l("label",{for:"quantity"},"Cantidad",-1),Ue={class:"flex align-items-center justify-content-center"},Ne=l("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),Ie={key:0},Ee={__name:"Producto",setup(Te){const V=ee();n("Gestión Productos");const U=n(null),p=n(!1),w=n(!1),y=n(!1);n(!1);const a=n({}),C=n(null),N=n(null),I=n({}),c=n(!1),T=n([]),P=n(!1),L=n(0),k=n({});ae(()=>{P.value=!0,k.value={first:0,rows:N.value.rows,sortField:null,sortOrder:null,filters:I.value},v(),q()});const v=async()=>{P.value=!0;let s=k.value.page+1,o=k.value.rows;const{data:u}=await h.listar(s,o);U.value=u.data,L.value=u.total,P.value=!1},q=async()=>{const{data:s}=await oe.listar();T.value=s},B=s=>{k.value=s,v()},$=s=>s.toLocaleString("en-US",{style:"currency",currency:"USD"}),A=()=>{a.value={},c.value=!1,p.value=!0},G=s=>{a.value=s,w.value=!0},M=()=>{p.value=!1,c.value=!1},j=async()=>{c.value=!0,a.value.nombre&&a.value.nombre.trim()&&a.value.precio&&(a.value.id?(await h.modificar(a.value,a.value.id),v(),V.add({severity:"success",summary:"Editado Correctamente",detail:"Producto Actualizado",life:3e3})):(console.log(a.value),await h.guardar(a.value),v(),V.add({severity:"success",summary:"Guardado Correctamente",detail:"Producto Registrado",life:3e3})),p.value=!1,a.value={})},O=s=>{a.value={...s},console.log(a),p.value=!0},K=s=>{a.value=s,y.value=!0},H=async()=>{await h.eliminar(a.value.id),v(),y.value=!1,a.value={},V.add({severity:"success",summary:"Eliminado",detail:"Producto Eliminado",life:3e3})},J=async s=>{const o=s.files[0];console.log(o);let u=new FormData;u.append("imagen",o),await h.actualizarImagen(a.value.id,u),a.value={},w.value=!1,v()};return(s,o)=>{const u=r("Toast"),d=r("Button"),R=r("FileUpload"),Q=r("Toolbar"),m=r("Column"),W=r("DataTable"),D=r("Dialog"),X=r("InputText"),Y=r("Textarea"),Z=r("RadioButton"),z=r("InputNumber");return b(),f(E,null,[l("div",le,[t(u),t(Q,{class:"mb-4"},{start:i(()=>[l("div",se,[t(d,{label:"Nuevo",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:A}),t(d,{label:"Eliminar",icon:"pi pi-trash",class:"p-button-danger",onClick:s.confirmDeleteSelected,disabled:!C.value||!C.value.length},null,8,["onClick","disabled"])])]),end:i(()=>[t(R,{mode:"basic",accept:"image/*",maxFileSize:1e6,label:"Import",chooseLabel:"Importar",class:"mr-2 inline-block"}),t(d,{label:"Exportar",icon:"pi pi-upload",class:"p-button-help",onClick:o[0]||(o[0]=e=>s.exportCSV(e))})]),_:1}),t(W,{ref_key:"dt",ref:N,value:U.value,selection:C.value,"onUpdate:selection":o[1]||(o[1]=e=>C.value=e),dataKey:"id",paginator:!0,lazy:"",totalRecords:L.value,loading:P.value,onPage:o[2]||(o[2]=e=>B(e)),rows:10,filters:I.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} productos",responsiveLayout:"scroll"},{header:i(()=>[ie]),default:i(()=>[t(m,{selectionMode:"multiple",headerStyle:"width: 3rem"}),t(m,{field:"id",header:"ID",sortable:!0,headerStyle:"width:7%; min-width:3rem;"},{body:i(e=>[ne,_(" "+g(e.data.id),1)]),_:1}),t(m,{field:"nombre",header:"Nombre",sortable:!0,headerStyle:"width:14%; min-width:8rem;"},{body:i(e=>[re,_(" "+g(e.data.nombre),1)]),_:1}),t(m,{header:"imagen",headerStyle:"width:14%; min-width:10rem;"},{body:i(e=>[de,l("img",{src:"http://127.0.0.1:8000/"+e.data.imagen,alt:e.data.nombre,class:"shadow-2",width:"100"},null,8,ce)]),_:1}),t(m,{field:"precio",header:"Precio",sortable:!0,headerStyle:"width:14%; min-width:4rem;"},{body:i(e=>[ue,_(" "+g($(e.data.precio)),1)]),_:1}),t(m,{field:"categoria_id",header:"Categoria",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:i(e=>[me,_(" "+g(e.data.categoria.nombre),1)]),_:1}),t(m,{headerStyle:"min-width:10rem;"},{body:i(e=>[t(d,{icon:"pi pi-image",onClick:x=>G(e.data)},null,8,["onClick"]),t(d,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:x=>O(e.data)},null,8,["onClick"]),t(d,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning mt-2",onClick:x=>K(e.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","selection","totalRecords","loading","filters"])]),t(D,{visible:w.value,"onUpdate:visible":o[3]||(o[3]=e=>w.value=e),modal:"",header:"Actualizar Imagen",style:{width:"50vw"}},{default:i(()=>[t(R,{name:"demo[]",customUpload:"",onUploader:J,multiple:!1,accept:"image/*"},{empty:i(()=>[pe]),_:1})]),_:1},8,["visible"]),t(D,{visible:p.value,"onUpdate:visible":o[9]||(o[9]=e=>p.value=e),style:{width:"450px"},header:"Detalles del Producto",modal:!0,class:"p-fluid"},{footer:i(()=>[t(d,{label:"Cancelar",icon:"pi pi-times",class:"p-button-text",onClick:M}),t(d,{label:"Guardar",icon:"pi pi-check",class:"p-button-text",onClick:j})]),default:i(()=>[l("div",ve,[be,t(X,{id:"name",modelValue:a.value.nombre,"onUpdate:modelValue":o[4]||(o[4]=e=>a.value.nombre=e),modelModifiers:{trim:!0},required:"true",autofocus:"",class:F({"p-invalid":c.value&&!a.value.nombre})},null,8,["modelValue","class"]),c.value&&!a.value.nombre?(b(),f("small",fe,"El Nombre es Oblogatorio.")):S("",!0)]),l("div",_e,[ge,t(Y,{id:"description",modelValue:a.value.descripcion,"onUpdate:modelValue":o[5]||(o[5]=e=>a.value.descripcion=e),required:"true",rows:"3",cols:"20"},null,8,["modelValue"])]),l("div",ye,[he,l("div",we,[(b(!0),f(E,null,te(T.value,e=>(b(),f("div",{class:"field-radiobutton col-6",key:e.id},[t(Z,{id:`category${e.id}`,name:"category",value:e.id,modelValue:a.value.categoria_id,"onUpdate:modelValue":o[6]||(o[6]=x=>a.value.categoria_id=x)},null,8,["id","value","modelValue"]),l("label",{for:`category${e.id}`},g(e.nombre),9,Ce)]))),128))])]),l("div",Pe,[l("div",ke,[xe,t(z,{id:"price",modelValue:a.value.precio,"onUpdate:modelValue":o[7]||(o[7]=e=>a.value.precio=e),mode:"currency",currency:"USD",locale:"en-US",class:F({"p-invalid":c.value&&!a.value.precio}),required:!0},null,8,["modelValue","class"]),c.value&&!a.value.precio?(b(),f("small",Ve,"Precio es requerido.")):S("",!0)]),l("div",De,[Se,t(z,{id:"quantity",modelValue:a.value.cantidad,"onUpdate:modelValue":o[8]||(o[8]=e=>a.value.cantidad=e),integeronly:""},null,8,["modelValue"])])])]),_:1},8,["visible"]),t(D,{visible:y.value,"onUpdate:visible":o[11]||(o[11]=e=>y.value=e),style:{width:"450px"},header:"Confirmar Eliminación",modal:!0},{footer:i(()=>[t(d,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:o[10]||(o[10]=e=>y.value=!1)}),t(d,{label:"Si",icon:"pi pi-check",class:"p-button-text",onClick:H})]),default:i(()=>[l("div",Ue,[Ne,a.value?(b(),f("span",Ie,[_("Esta seguro de eliminar el Producto: "),l("b",null,g(a.value.nombre),1),_("?")])):S("",!0)])]),_:1},8,["visible"])],64)}}};export{Ee as default};
